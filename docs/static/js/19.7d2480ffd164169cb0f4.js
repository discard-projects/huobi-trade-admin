webpackJsonp([19],{Mocy:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("aA9S"),i=n.n(o),r=n("AISp"),a={mixins:[n("gMjF").a]},l={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-form",{ref:"form",attrs:{model:t.form,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[n("el-input",{model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1),t._v(" "),t.form.id?t._e():n("el-form-item",{attrs:{label:"密码",prop:"password",rules:[t.$validators.required()]}},[n("el-input",{model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"姓名",prop:"name"}},[n("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"昵称",prop:"nickname"}},[n("el-input",{model:{value:t.form.nickname,callback:function(e){t.$set(t.form,"nickname",e)},expression:"form.nickname"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"角色",prop:"role_ids"}},[n("ex-model-select",{attrs:{api:"/roles",labelKey:"name",multiple:""},model:{value:t.form.role_ids,callback:function(e){t.$set(t.form,"role_ids",e)},expression:"form.role_ids"}})],1),t._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary",loading:t.uploading,disabled:t.fetching},on:{click:function(e){return t.onSubmit("form")}}},[t._v(t._s(t.form.id?"更新":"创建"))]),t._v(" "),t.form.id?t._e():n("el-button",{on:{click:function(e){return t.onReset("form")}}},[t._v("重置")])],1)],1)},staticRenderFns:[]},s=n("C7Lr")(a,l,!1,null,null,null).exports,c={data:function(){return{dialogVisible:!0,form:{email:"",password:"",name:"",nickname:"",role_ids:[]}}},methods:{handler:function(){var t=this;return this.api.createAdmin(this.form).then(function(e){e.data;t.$root.owner.fetchData(),t.$ext.unmount(t)})}},components:{innerForm:s}},m={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{title:"新增",visible:t.dialogVisible,width:"80%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("inner-form",{attrs:{form:t.form,handler:t.handler}})],1)},staticRenderFns:[]},f=n("C7Lr")(c,m,!1,null,null,null).exports,u={mixins:[n("gf7+").a],methods:{fetchData:function(){return this._fetchData(this.api.getAdmin(this.item.id))},handler:function(){return this._handler(this.api.updateAdmin(this.item.id,this.form))}},components:{innerForm:s}},d={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{title:"编辑",visible:t.dialogVisible,width:"80%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("inner-form",{attrs:{form:t.form,handler:t.handler,fetching:t.fetching}})],1)},staticRenderFns:[]},p=n("C7Lr")(u,d,!1,null,null,null).exports,h={props:{item:Object},data:function(){return{dialogVisible:!0,uploading:!1,form:{password:"",password_confirmation:""}}},methods:{onSubmit:function(t){var e=this;this.$refs[t].validate(function(t){if(t)return e.uploading=!0,e.api.updateAdminPassword(e.item.id,e.form).then(function(t){t.data;e.uploading=!1,e.$root.owner.fetchData(),e.$ext.unmount(e)}).catch(function(t){console.log(t),e.uploading=!1})})}},components:{}},b={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{title:"更新密码",visible:t.dialogVisible,width:"80%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("el-form",{ref:"form",attrs:{model:t.form,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"密码",prop:"password",rules:[t.$validators.required()]}},[n("el-input",{attrs:{type:"password"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"确认密码",prop:"password_confirmation",rules:[t.$validators.required()]}},[n("el-input",{attrs:{type:"password"},model:{value:t.form.password_confirmation,callback:function(e){t.$set(t.form,"password_confirmation",e)},expression:"form.password_confirmation"}})],1),t._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary",loading:t.uploading},on:{click:function(e){return t.onSubmit("form")}}},[t._v("更新")])],1)],1)],1)},staticRenderFns:[]},v=n("C7Lr")(h,b,!1,null,null,null).exports,_={mixins:[r.a],data:function(){return{footprints:[]}},methods:{fetchData:function(){this._fetchData(this.api.getAdmins(this.mixTableParams))},showNewDialog:function(){this.$ext.mount(f,{onEl:this.$el,data:{owner:this}})},fetchItemFootprints:function(t){var e=this;this.api.getAdminFootprints(t.id).then(function(t){e.footprints=t.data.items})},showEditPasswordDialog:function(t){this.$ext.mount(v,{onEl:this.$el,props:{item:t},data:{owner:this}})},showEditDialog:function(t){this.$ext.mount(p,{onEl:this.$el,props:{item:t},data:{owner:this}})},destroy:function(t){var e=this;this.$confirm("确定要删除该条信息吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",callback:function(n){"confirm"===n&&(e.$set(t,"deleting",!0),e.api.deleteAdmin(t.id).then(function(n){e.$set(t,"deleting",!1),e.$message.success("删除成功了！"),e.fetchData()}).catch(function(n){console.error(n),e.$message.error("删除报错了！"),e.$set(t,"deleting",!1)}))}})},updatePosition:function(t,e){console.log(t,e)}},created:function(){var t=this;this.mixTableData=i()(this.mixTableData,{queryIntros:[{control:"input",key:"q_name_cont",placeholder:"名称"}],dragable:function(e,n,o){t.api.updateAdminPosition(e.id,{position:n}).then(function(e){t.fetchData()}).catch(function(e){console.error(e),t.fetchData()})},dataIntros:[{label:"#",key:"id",width:80},{label:"邮箱",key:"email"},{label:"姓名",key:"name"},{label:"昵称",key:"nickname"},{label:"角色",key:"role_names"},{label:"创建时间",key:"created_time"},{label:"更新时间",key:"updated_time"}],opIntro:{label:"操作",width:180}})}},g={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("ex-table",{attrs:{tableData:t.mixTableData},on:{refetch:t.fetchData},scopedSlots:t._u([{key:"search-bar-item",fn:function(e){var o=e.search;return[n("el-form-item",{key:o.key,attrs:{label:o.label}},[n("ex-options-select",{attrs:{options:[{label:"工作者",value:"category_worker"}]},model:{value:t.mixTableData.query[o.key],callback:function(e){t.$set(t.mixTableData.query,o.key,e)},expression:"mixTableData.query[search.key]"}})],1)]}},{key:"id",fn:function(e){var o=e.row;return e.$index,e.intro,[n("el-button",{attrs:{type:"text"},on:{click:function(e){return t.$refs.footprintRef.showDialog(o)}}},[t._v(t._s(o.id))])]}},{key:"cover",fn:function(t){var e=t.row;return t.$index,t.intro,[n("img",{staticStyle:{"max-width":"50px","max-height":"50px"},attrs:{src:e.cover_link,alt:""}})]}},{key:"table-operations",fn:function(e){var o=e.row;return e.$index,e.intro,[n("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.showEditPasswordDialog(o)}}},[t._v("更新密码")]),t._v(" "),n("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.showEditDialog(o)}}},[t._v("编辑")]),t._v(" "),n("el-button",{attrs:{size:"mini",type:"danger",loading:o.deleting},on:{click:function(e){return t.destroy(o)}}},[t._v("删除")])]}}])},[t._v(" "),n("div",{attrs:{slot:"search-bar-operations"},slot:"search-bar-operations"},[n("el-button",{attrs:{size:"small"},on:{click:t.showNewDialog}},[t._v("新增")]),t._v(" "),n("footprint",{ref:"footprintRef",attrs:{footprints:t.footprints},on:{fetchItemFootprints:t.fetchItemFootprints,"update:footprints":function(e){t.footprints=e}}})],1)])],1)},staticRenderFns:[]},w=n("C7Lr")(_,g,!1,null,null,null);e.default=w.exports}});