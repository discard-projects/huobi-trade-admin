webpackJsonp([8],{"3iJ2":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("aA9S"),i=a.n(r),s=a("AISp"),n={mixins:[a("gMjF").a],watch:{"form.dic_area_id_with_parents":{handler:function(t){t&&t.length?this.form.dic_area_id=t[t.length-1]:this.form.dic_area_id=null},deep:!0}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"用户",prop:"user_id"}},[a("ex-model-select",{attrs:{api:"/users",labelKey:"name",labelKeySearch:"mobile"},model:{value:t.form.user_id,callback:function(e){t.$set(t.form,"user_id",e)},expression:"form.user_id"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"护工",prop:"worker_id"}},[a("ex-model-select",{attrs:{api:"/workers",labelKey:"name",labelKeySearch:"mobile"},model:{value:t.form.worker_id,callback:function(e){t.$set(t.form,"worker_id",e)},expression:"form.worker_id"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"联系人",prop:"contact_name"}},[a("el-input",{model:{value:t.form.contact_name,callback:function(e){t.$set(t.form,"contact_name",e)},expression:"form.contact_name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"联系方式",prop:"contact_mobile"}},[a("el-input",{model:{value:t.form.contact_mobile,callback:function(e){t.$set(t.form,"contact_mobile",e)},expression:"form.contact_mobile"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"开始时间",prop:"begin_at"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择开始日期"},model:{value:t.form.begin_at,callback:function(e){t.$set(t.form,"begin_at",e)},expression:"form.begin_at"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"结束时间",prop:"end_at"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择结束日期"},model:{value:t.form.end_at,callback:function(e){t.$set(t.form,"end_at",e)},expression:"form.end_at"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"服务对象",prop:"service_person_id"}},[a("ex-model-select",{attrs:{api:"/service_people",labelKey:"name"},model:{value:t.form.service_person_id,callback:function(e){t.$set(t.form,"service_person_id",e)},expression:"form.service_person_id"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"支付类型",prop:"pay_category"}},[a("ex-options-select",{attrs:{options:[{label:"支付定金",value:"pay_category_down"},{label:"全额支付",value:"pay_category_full"}]},model:{value:t.form.pay_category,callback:function(e){t.$set(t.form,"pay_category",e)},expression:"form.pay_category"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"护理地点",prop:"place_category"}},[a("ex-options-select",{attrs:{options:[{label:"医院护理",value:"place_category_hospital"},{label:"居家护理",value:"place_category_home"}]},model:{value:t.form.place_category,callback:function(e){t.$set(t.form,"place_category",e)},expression:"form.place_category"}})],1),t._v(" "),t.originForm?a("el-form-item",{attrs:{label:"地区",prop:"dic_area_id_with_parents"}},[a("area-cascader",{model:{value:t.form.dic_area_id_with_parents,callback:function(e){t.$set(t.form,"dic_area_id_with_parents",e)},expression:"form.dic_area_id_with_parents"}})],1):t._e(),t._v(" "),a("el-form-item",{attrs:{label:"地址",prop:"address"}},[a("el-input",{attrs:{type:"textarea",placeholder:"如: 仓兴街 18号"},model:{value:t.form.address,callback:function(e){t.$set(t.form,"address",e)},expression:"form.address"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:t.uploading,disabled:t.fetching},on:{click:function(e){return t.onSubmit("form")}}},[t._v(t._s(t.form.id?"更新":"创建"))]),t._v(" "),t.form.id?t._e():a("el-button",{on:{click:function(e){return t.onReset("form")}}},[t._v("重置")])],1)],1)},staticRenderFns:[]},l=a("C7Lr")(n,o,!1,null,null,null).exports,c={data:function(){return{dialogVisible:!0,form:{user_id:"",worker_id:"",contact_name:"",contact_mobile:"",begin_at:"",end_at:"",service_person_id:"",status:"",pay_category:"",place_category:"",dic_area_id:"",dic_area_id_with_parents:[],address:""}}},methods:{handler:function(){var t=this;return this.api.createOrder(this.form).then(function(e){e.data;t.$root.owner.fetchData(),t.$ext.unmount(t)})}},components:{innerForm:l}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"新增",visible:t.dialogVisible,width:"80%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("inner-form",{attrs:{form:t.form,handler:t.handler}})],1)},staticRenderFns:[]},_=(a("C7Lr")(c,u,!1,null,null,null).exports,a("gf7+")),d={mixins:[_.a],methods:{fetchData:function(){return this._fetchData(this.api.getOrder(this.item.id))},handler:function(){return this._handler(this.api.updateOrder(this.item.id,this.form))}},components:{innerForm:l}},f={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"编辑",visible:t.dialogVisible,width:"80%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("inner-form",{attrs:{form:t.form,handler:t.handler,fetching:t.fetching}})],1)},staticRenderFns:[]},p=a("C7Lr")(d,f,!1,null,null,null).exports,m={mixins:[_.a],methods:{fetchData:function(){return this._fetchData(this.api.getOrder(this.item.id))}}},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"详情",visible:t.dialogVisible,width:"80%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("ui-json",{attrs:{json:t.form}})],1)},staticRenderFns:[]},b=a("C7Lr")(m,h,!1,null,null,null).exports,v={mixins:[s.a],data:function(){return{footprints:[],json:null,statusOptions:[{value:"status_created"},{value:"status_pending"},{value:"status_processing"},{value:"status_successful"},{value:"status_failed"},{value:"status_expired"},{value:"status_canceled"},{value:"status_closed"}]}},methods:{fetchData:function(){this._fetchData(this.api.getOrders(this.mixTableParams))},fetchItemFootprints:function(t){var e=this;this.api.getOrderFootprints(t.id).then(function(t){e.footprints=t.data.items})},showEditDialog:function(t){this.$ext.mount(p,{onEl:this.$el,props:{item:t},data:{owner:this}})},showDetailDialog:function(t){this.$ext.mount(b,{onEl:this.$el,props:{item:t},data:{owner:this}})},stopTrack:function(t,e){var a=this;this.$confirm("停止追踪将会把设定价格交易关闭，需要手动打开，请确认？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",callback:function(r){"confirm"===r&&a.api.updateOrderStatus(t.id,e).then(function(a){t.status=e})}})},updateOrderStatus:function(t,e){var a=this;this.$confirm("确定更改吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.api.updateOrderStatus(t.id,e).then(function(t){a.fetchData()})})}},created:function(){this.mixTableData=i()(this.mixTableData,{queryIntros:[{control:"input",key:"q_symbol_cont",placeholder:"币种"},{control:"custom",key:"q_kind_eq",placeholder:"交易种类"}],dataIntros:[{label:"#",key:"id",width:150},{label:"下单方式",key:"kind",width:100},{label:"交易对",key:"symbol",width:100},{label:"买入/卖出",key:"category",width:80},{label:"交易状态",key:"status",width:100},{label:"三方交易状态",key:"state",width:120},{label:"数量",key:"amount"},{label:"价格",key:"price"},{label:"已成交量",key:"field_amount"},{label:"已成交金额",key:"field_cash_amount"},{label:"已成交手续费",key:"field_fees",width:100},{label:"创建时间",key:"create_time",width:140},{label:"交易完成时间",key:"finish_time",width:140}],opIntro:{label:"操作",width:130}})}},y={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("ex-table",{attrs:{tableData:t.mixTableData},on:{refetch:t.fetchData},scopedSlots:t._u([{key:"search-bar-item",fn:function(e){var r=e.search;return[a("el-form-item",{key:r.key,attrs:{label:r.label}},[a("ex-options-select",{attrs:{clearable:!0,options:[{label:"APP下单",value:"kind_app"},{label:"接口下单[固定值]",value:"kind_custom_price"},{label:"计划下单[多节点]",value:"kind_plan"},{label:"智能下单[倍数]",value:"kind_smart"},{label:"自动下单[智能分析]",value:"kind_auto",disabled:!0}],placeholder:"交易种类"},model:{value:t.mixTableData.query[r.key],callback:function(e){t.$set(t.mixTableData.query,r.key,e)},expression:"mixTableData.query[search.key]"}})],1)]}},{key:"id",fn:function(e){var r=e.row;return e.$index,e.intro,[a("el-button",{attrs:{type:"text",icon:"el-icon-time"},on:{click:function(e){return t.$refs.footprintRef.showDialog(r)}}}),t._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(e){return t.showDetailDialog(r)}}},[t._v(t._s(r.id))])]}},{key:"kind",fn:function(e){var r=e.row;return["kind_app"==r.kind?a("ex-status-tag",{attrs:{type:"info"}},[t._v("APP下单")]):"kind_custom_price"==r.kind?a("ex-status-tag",[t._v("固定值下单")]):"kind_auto"==r.kind?a("ex-status-tag",{attrs:{type:"success"}},[t._v("自动下单")]):"kind_plan"==r.kind?a("ex-status-tag",{attrs:{type:"success"}},[t._v("计划下单")]):"kind_smart"==r.kind?a("ex-status-tag",{attrs:{type:"primary"}},[t._v("智能下单")]):t._e()]}},{key:"symbol",fn:function(e){var a=e.row;return[t._v("\n      "+t._s(a.symbol_base_currency.toUpperCase())+" / "+t._s(a.symbol_quote_currency.toUpperCase())+"\n    ")]}},{key:"category",fn:function(e){var r=e.row;return["category_buy"==r.category?a("ex-status-tag",{attrs:{type:"success"}},[t._v("买入")]):t._e(),t._v(" "),"category_sell"==r.category?a("ex-status-tag",{attrs:{type:"danger"}},[t._v("卖出")]):t._e()]}},{key:"status",fn:function(e){var r=e.row;return["status_created"==r.status?a("ex-status-tag",[t._v("已提交")]):t._e(),t._v(" "),"status_filled"==r.status?a("ex-status-tag",{attrs:{type:"success"}},[t._v("已成交")]):t._e(),t._v(" "),"status_finished"==r.status?a("ex-status-tag",{attrs:{type:"success"}},[t._v("完成交易")]):t._e(),t._v(" "),"status_untracked"==r.status?a("ex-status-tag",{attrs:{type:"info"}},[t._v("停止追踪")]):t._e(),t._v(" "),"status_canceled"==r.status?a("ex-status-tag",{attrs:{type:"danger"}},[t._v("已取消")]):t._e()]}},{key:"state",fn:function(e){var r=e.row;return["submitted"==r.state?a("ex-status-tag",{attrs:{type:"info"}},[t._v("已提交")]):"partial-filled"==r.state?a("ex-status-tag",{attrs:{type:"info"}},[t._v("部分成交")]):"partial-canceled"==r.state?a("ex-status-tag",{attrs:{type:"info"}},[t._v("部分成交撤销")]):"filled"==r.state?a("ex-status-tag",{attrs:{type:"info"}},[t._v("完全成交")]):"canceled"==r.state?a("ex-status-tag",{attrs:{type:"info"}},[t._v("已撤销")]):t._e()]}},{key:"price",fn:function(e){var r=e.row;return["buy-limit"==r.ctype?a("ex-status-tag",{attrs:{type:"success"}},[t._v(t._s(r.price))]):"sell-limit"==r.ctype?a("ex-status-tag",{attrs:{type:"danger"}},[t._v(t._s(r.price))]):a("el-tag",[t._v(t._s(r.price))])]}},{key:"finish_time",fn:function(e){var a=e.row;return[t._v("\n      "+t._s(a.finish_time.match("1970")?"":a.finish_time)+"\n    ")]}},{key:"table-operations",fn:function(e){var r=e.row;return e.$index,e.intro,["kind_custom_price"===r.kind&&-1!==["status_filled"].indexOf(r.status)&&"category_buy"===r.category?a("el-button",{staticStyle:{margin:"5px"},attrs:{size:"mini"},on:{click:function(e){return t.stopTrack(r,"status_untracked")}}},[t._v("停止追踪卖出")]):t._e()]}}])},[t._v(" "),a("div",{attrs:{slot:"search-bar-operations"},slot:"search-bar-operations"},[a("footprint",{ref:"footprintRef",attrs:{footprints:t.footprints},on:{fetchItemFootprints:t.fetchItemFootprints,"update:footprints":function(e){t.footprints=e}}})],1)])],1)},staticRenderFns:[]},g=a("C7Lr")(v,y,!1,null,null,null);e.default=g.exports}});