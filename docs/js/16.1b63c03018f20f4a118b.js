webpackJsonp([16],{CmHi:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l("xd7I"),i=l("aA9S"),r=l.n(i),a=l("AISp"),o=l("a3Yh"),s=l.n(o),c=l("4gzT"),d={name:"DialogSubAreas",props:{level:{type:String,default:"level_province"},parentId:[Number],title:{default:"详情"}},watch:{dialogVisible:function(e){e||this.$ext.unmount(this)}},data:function(){return{dialogVisible:!0}},components:s()({},c.Dialog.name,c.Dialog)},u={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("el-dialog",{attrs:{title:e.title,visible:e.dialogVisible,"append-to-body":"",width:"90%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[l("areas-template",{attrs:{level:e.level,parentId:e.parentId}})],1)},staticRenderFns:[]},m=l("C7Lr")(d,u,!1,null,null,null).exports,f={mixins:[l("gMjF").a],computed:{parentLevel:function(){return"level_district"===this.form.level?"level_city":"level_city"===this.form.level?"level_province":"level_province"===this.form.level?"level_country":void 0}}},p={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px"}},[e.originForm?l("el-form-item",{attrs:{label:"上级归属",prop:"parent_id"}},[l("ex-model-select",{attrs:{"default-value":e.originForm.parent_id,api:"/dic/areas",extraParams:{q_level_eq:e.parentLevel},labelKey:"name"},model:{value:e.form.parent_id,callback:function(t){e.$set(e.form,"parent_id",t)},expression:"form.parent_id"}})],1):e._e(),e._v(" "),l("el-form-item",{attrs:{label:"名称",prop:"name"}},[l("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"AdCode",prop:"adcode"}},[l("el-input",{model:{value:e.form.adcode,callback:function(t){e.$set(e.form,"adcode",t)},expression:"form.adcode"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"Level"}},[l("ex-options-select",{attrs:{options:[{label:"省级",value:"level_province"},{label:"市级",value:"level_city"},{label:"县级",value:"level_district"}]},model:{value:e.form.level,callback:function(t){e.$set(e.form,"level",t)},expression:"form.level"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"经度",prop:"lng"}},[l("el-input",{model:{value:e.form.lng,callback:function(t){e.$set(e.form,"lng",t)},expression:"form.lng"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"纬度",prop:"lat"}},[l("el-input",{model:{value:e.form.lat,callback:function(t){e.$set(e.form,"lat",t)},expression:"form.lat"}})],1),e._v(" "),l("el-form-item",[l("el-button",{attrs:{type:"primary",loading:e.uploading,disabled:e.fetching},on:{click:function(t){return e.onSubmit("form")}}},[e._v(e._s(e.form.id?"更新":"创建"))]),e._v(" "),e.form.id?e._e():l("el-button",{on:{click:function(t){return e.onReset("form")}}},[e._v("重置")])],1)],1)},staticRenderFns:[]},h=l("C7Lr")(f,p,!1,null,null,null).exports,v={props:{parentId:[Number]},data:function(){return{dialogVisible:!0,form:{adcode:"",name:"",parent_id:this.parentId}}},methods:{handler:function(){var e=this;return this.api.createDicArea(this.form).then(function(t){t.data;e.$root.owner.fetchData(),e.$ext.unmount(e)})}},components:{innerForm:h}},b={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("el-dialog",{attrs:{title:"新增",visible:e.dialogVisible,width:"600px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[l("inner-form",{attrs:{form:e.form,handler:e.handler}})],1)},staticRenderFns:[]},_=l("C7Lr")(v,b,!1,null,null,null).exports,g={mixins:[l("gf7+").a],methods:{fetchData:function(){return this._fetchData(this.api.getDicArea(this.item.id))},handler:function(){return this._handler(this.api.updateDicArea(this.item.id,this.form))}},components:{innerForm:h}},x={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("el-dialog",{attrs:{title:"编辑",visible:e.dialogVisible,width:"600px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[l("inner-form",{attrs:{form:e.form,handler:e.handler,fetching:e.fetching}})],1)},staticRenderFns:[]},y=l("C7Lr")(g,x,!1,null,null,null).exports,$={name:"AreasTemplate",mixins:[a.a],props:{level:{type:String,default:"level_province"},parentId:{type:[Number],default:1}},methods:{fetchData:function(){return this._fetchData(this.api.getDicAreas(r()({q_level_eq:this.level,parent_id:this.parentId},this.mixTableParams)))},showSubAreas:function(e){var t="";"level_province"===this.level?t="level_city":"level_city"===this.level&&(t="level_district"),this.$ext.mount(m,{props:{level:t,parentId:e.id}})},showNewDialog:function(){this.$ext.mount(_,{data:{$route:this.$route,owner:this},props:{parentId:this.parentId}})},showEditDialog:function(e){this.$ext.mount(y,{data:{owner:this},props:{item:e}})},destroy:function(e){var t=this;this.$confirm("确定要删除该条信息吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",callback:function(l){"confirm"===l&&(t.$set(e,"deleting",!0),t.api.deleteDicArea(e.id).then(function(l){t.$set(e,"deleting",!1),t.$message.success("删除成功了！"),t.fetchData()}).catch(function(l){console.error(l),t.$message.error("删除报错了！"),t.$set(e,"deleting",!1)}))}})}},created:function(){var e=this;this.mixTableData=r()(this.mixTableData,{queryIntros:[{control:"input",key:"q_name_cont",placeholder:this.level}],dragable:function(t,l,n){e.api.updateDicAreaPosition(t.id,{position:l}).then(function(t){e.fetchData()}).catch(function(t){console.error(t),e.fetchData()})},dataIntros:[{label:"#",key:"id",width:100},{label:"省份",key:"name"},{label:"AdCode",key:"adcode"},{label:"级别",key:"level"},{label:"经度",key:"lng"},{label:"纬度",key:"lat"},{label:"创建时间",key:"created_time",sortable:"created_at",width:160},{label:"更新时间",key:"updated_time",width:160}],opIntro:{label:"操作",width:180}})}},D={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("ex-table",{attrs:{tableData:e.mixTableData},on:{refetch:e.fetchData},scopedSlots:e._u([{key:"name",fn:function(t){var n=t.row;return t.$index,t.intro,[l("el-button",{attrs:{type:"text"},on:{click:function(t){return e.showSubAreas(n)}}},[e._v(e._s(n.name))])]}},{key:"table-operations",fn:function(t){var n=t.row;return t.$index,t.intro,[l("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.showEditDialog(n)}}},[e._v("编辑")]),e._v(" "),l("el-button",{attrs:{size:"mini",type:"danger",loading:n.deleting},on:{click:function(t){return e.destroy(n)}}},[e._v("删除")])]}}])},[l("div",{attrs:{slot:"search-bar-operations"},slot:"search-bar-operations"},[l("el-button",{attrs:{size:"small"},on:{click:e.showNewDialog}},[e._v("新增")])],1)])},staticRenderFns:[]},k=l("C7Lr")($,D,!1,null,null,null).exports;n.default.component(k.name,k);var w={render:function(){var e=this.$createElement;return(this._self._c||e)("areas-template")},staticRenderFns:[]},I=l("C7Lr")({},w,!1,null,null,null);t.default=I.exports}});